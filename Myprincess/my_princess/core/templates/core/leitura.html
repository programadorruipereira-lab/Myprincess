{% extends 'core/base.html' %}

{% block content %}
<div class="card">
    <h2>üìö Minhas Leituras</h2>
    <button onclick="document.getElementById('livroForm').style.display='block'" class="btn btn-primary">Novo Livro</button>
    
    <div id="livroForm" style="display:none; margin-top: 1rem;">
        <form method="post">
            {% csrf_token %}
            <label>T√≠tulo</label>
            <input type="text" name="titulo" required>
            
            <label>Autor</label>
            <input type="text" name="autor" required>
            
            <label>Status</label>
            <select name="status">
                <option value="Lendo">Lendo</option>
                <option value="Lido">Lido</option>
                <option value="Quero Ler">Quero Ler</option>
            </select>
            
            <button type="submit" class="btn btn-accent mt-4">Salvar</button>
        </form>
    </div>
</div>

<div class="grid-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
    {% for livro in livros %}
    <div class="card" style="padding: 1.5rem;">
        <h4>{{ livro.titulo }}</h4>
        <p style="color: #666;">{{ livro.autor }}</p>
        
        <div style="margin-top: 0.5rem; display: flex; align-items: center; justify-content: space-between;">
            <form action="{% url 'update_livro_status' livro.id %}" method="post">
                {% csrf_token %}
                <select name="status" onchange="this.form.submit()" style="padding: 2px; font-size: 0.8rem;">
                    <option value="Quero Ler" {% if livro.status == 'Quero Ler' %}selected{% endif %}>Quero Ler</option>
                    <option value="Lendo" {% if livro.status == 'Lendo' %}selected{% endif %}>Lendo</option>
                    <option value="Lido" {% if livro.status == 'Lido' %}selected{% endif %}>Lido</option>
                </select>
            </form>
            <form action="{% url 'delete_item' 'Livro' livro.id %}" method="post" onsubmit="return confirm('Remover?');">
                {% csrf_token %}
                <button type="submit" style="background: none; border: none; cursor: pointer;">üóëÔ∏è</button>
            </form>
        </div>
    </div>
    {% empty %}
    <p>Nenhum livro na estante.</p>
    {% endfor %}
</div>
{% endblock %}
